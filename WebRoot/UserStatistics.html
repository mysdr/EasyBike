<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>后台模板</title>
<link rel="stylesheet" href="assets/css/amazeui.css" />
<link rel="stylesheet"
	href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
<link rel="stylesheet" href="assets/css/core.css" />
<link rel="stylesheet" href="assets/css/menu.css" />
<link rel="stylesheet" href="assets/css/index.css" />
<link rel="stylesheet" href="assets/css/admin.css" />
<link rel="stylesheet" href="assets/css/page/typography.css" />
<link rel="stylesheet" href="assets/css/page/form.css" />
<link rel="stylesheet" href="assets/css/jquery.page.css" />


<script type="text/javascript">
	function loadData(num) {
		layer.alert(num);
		console.log(num);
	}
</script>
</head>
<body>
	<!-- Begin page -->
	<header class="am-topbar am-topbar-fixed-top">
		<div class="am-topbar-left am-hide-sm-only">
			<a href="index.html" class="logo"><span>Easy<span>Bike</span>
			</span><i class="zmdi zmdi-layers"></i> </a>
		</div>

		<div class="contain">
			<ul class="am-nav am-navbar-nav am-navbar-left">

				<li><h4 class="page-title">用户管理</h4></li>
			</ul>

			<ul class="am-nav am-navbar-nav am-navbar-right">
				<li class="inform"><i class="am-icon-bell-o" aria-hidden="true"></i>
				</li>
				<li class="hidden-xs am-hide-sm-only">
					<form role="search" class="app-search">
						<input type="text" placeholder="Search..." class="form-control">
						<a href=""><img src="assets/img/search.png"> </a>
					</form>
				</li>
			</ul>
		</div>
	</header>
	<!-- end page -->



	<div class="admin">
		<!--<div class="am-g">-->
		<!-- ========== Left Sidebar Start ========== -->
		<!--<div class="left side-menu am-hide-sm-only am-u-md-1 am-padding-0">
			<div class="slimScrollDiv" style="position: relative; overflow: hidden; width: auto; height: 548px;">
				<div class="sidebar-inner slimscrollleft" style="overflow: hidden; width: auto; height: 548px;">-->
		<!-- sidebar start -->
		<div class="admin-sidebar am-offcanvas  am-padding-0"
			id="admin-offcanvas" style="overflow-y: hidden;">
			<div class="am-offcanvas-bar admin-offcanvas-bar">
				<!-- User -->
				<div class="user-box am-hide-sm-only">
					<div class="user-img">
						<img src="assets/img/avatar-1.jpg" alt="user-img"
							title="Mat Helme" class="img-circle img-thumbnail img-responsive">
						<div class="user-status offline">
							<i class="am-icon-dot-circle-o" aria-hidden="true"></i>
						</div>
					</div>
					<h5>
						<a href="#">管理员</a>
					</h5>
					<ul class="list-inline">
						<li><a href="#"> <i class="fa fa-cog" aria-hidden="true"></i>
						</a></li>

						<li><a href="#" class="text-custom"> <i class="fa fa-cog"
								aria-hidden="true"></i>
						</a></li>
					</ul>
				</div>
				<!-- End User -->

				<ul class="am-list admin-sidebar-list">
					<li><a href="index.html"><span class="am-icon-home"></span>
							首页</a></li>
					<li class="admin-parent"><a class="am-cf"
						data-am-collapse="{target: '#collapse-nav1'}"><span
							class="am-icon-line-chart"></span> 单车管理 <span
							class="am-icon-angle-right am-fr am-margin-right"></span> </a>
						<ul class="am-list am-collapse admin-sidebar-sub am-in"
							id="collapse-nav1">
							<li><a href="BikeManage.html" class="am-cf"> 单车位置
							</a></li>
							<li><a href="TraceManage.html">投放推荐</a></li>
						</ul></li>
					<li class="admin-parent"><a class="am-cf"
						data-am-collapse="{target: '#collapse-nav2'}"><span
							class="am-icon-line-chart"></span> 用户管理 <span
							class="am-icon-angle-right am-fr am-margin-right"></span> </a>
						<ul class="am-list am-collapse admin-sidebar-sub am-in"
							id="collapse-nav2">
							<li><a href="UserStatistics.html" class="am-cf"> 统计信息
							</a></li>
							<li><a href="UserManage.html">用户列表</a></li>
						</ul></li>
					<li><a href="RepairManage.html"><span class="am-icon-file"></span>
							维修管理</a></li>
					<li><a href="mobikeAnalysis.html"><span class="am-icon-file"></span>
					摩拜单车移动轨迹</a></li>
				</ul>
			</div>
		</div>
		<!-- sidebar end -->

		<!--</div>
			</div>
		</div>-->
		<!-- ========== Left Sidebar end ========== -->



		<!--	<div class="am-g">-->
		<!-- ============================================================== -->
		<!-- Start right Content here -->
		<div class="content-page">
			<!-- Start content -->
			<div class="content">
			
				<div class="am-u-md-12">
					<div class="card-box">				
						<h3>&nbsp;&nbsp;&nbsp;&nbsp;近期用户增长情况</h3>
						<hr />
						<div id="userupdatechart" style="width: 100%;height:400px;"></div>
						<hr/>
						<p id = "time3"></p>
					</div>
				</div>
				<div class="am-u-md-6">
					<div class="card-box">				
						<h3>&nbsp;&nbsp;&nbsp;&nbsp;近一周活跃用户数分布</h3>
						<hr />
						<div id="useactivechart" style="width: 600px;height:400px;"></div>
						<hr/>
						<p id = "time2"></p>
					</div>
				</div>
				<div class="am-u-md-6">
					<div class="card-box">
						<h3>&nbsp;&nbsp;&nbsp;&nbsp;性别分布</h3>
						<hr />
						<div id="usegenderchart" style="width: 600px;height:400px;"></div>
						<hr/>
						<p id = "time1"></p>
					</div>
				</div>
				
			</div>
		</div>
	</div>
	<!-- end right Content here -->

	<!-- navbar -->
	<a href="admin-offcanvas"
		class="am-icon-btn am-icon-th-list am-show-sm-only admin-menu"
		data-am-offcanvas="{target: '#admin-offcanvas'}"> <!--<i class="fa fa-bars" aria-hidden="true"></i>-->
	</a>

	<script type="text/javascript" src="assets/js/jquery-2.1.0.js"></script>
	<script type="text/javascript" src="assets/js/amazeui.min.js"></script>
	<script type="text/javascript" src="assets/js/app.js"></script>
	<script type="text/javascript" src="assets/js/blockUI.js"></script>
	<script src="https://cdn.hcharts.cn/highcharts/highcharts.js"></script>
	<script type="text/javascript" src="assets/js/charts/echarts.min.js"></script>
	<script type="text/javascript" src="assets/js/layer.js"></script>
	<script type="text/javascript">
		$(window).on('load', function() {
			initChartGender();
			initChartActiveUser();
			initChartUserUpdate();
			getCurrentTime();
		});
	</script>

	<script type="text/javascript">
	function initChartGender(){
		// 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('usegenderchart'));

        // 指定图表的配置项和数据
		var	option = {
		    title : {
		        text: '性别分布',
		        x:'center'
		    },
		    tooltip : {
		        trigger: 'item',
		        formatter: "{a} <br/>{b} : {c} ({d}%)"
		    },
		    legend: {
		        orient: 'vertical',
		        left: 'left',
		        data: ['男','女']
		    },
		    series : [
		        {
		            name: '性别分布',
		            type: 'pie',
		            radius : '55%',
		            center: ['50%', '60%'],
		            data:[
		                {value:335, name:'男'},
		                {value:310, name:'女'}
		            ],
		            itemStyle: {
		                emphasis: {
		                    shadowBlur: 10,
		                    shadowOffsetX: 0,
		                    shadowColor: 'rgba(0, 0, 0, 0.5)'
		                }
		            }
		        }
		    ]
		};
        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
        //動態設置數據
        myChart.showLoading();
        getChartGenderData(myChart);
	}
	</script>
	
	<script type="text/javascript">
	function initChartActiveUser(){
		// 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('useactivechart'));
		var option = {
		    title : {
		        text: '近一周活跃用户量分布',
		        x:'center'
		    },
		    color: ['#3398DB'],
		    tooltip : {
		        trigger: 'axis',
		        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
		            type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
		        }
		    },
		    grid: {
		        left: '3%',
		        right: '4%',
		        bottom: '3%',
		        containLabel: true
		    },
		    xAxis : [
		        {
		            type : 'category',
		            data : ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
		            axisTick: {
		                alignWithLabel: true
		            }
		        }
		    ],
		    yAxis : [
		        {
		            type : 'value'
		        }
		    ],
		    series : [
		        {
		            name:'活跃用户数',
		            type:'bar',
		            barWidth: '60%',
		            data:[10, 52, 200, 334, 390, 330, 220]
		        }
		    ]
		};
		
		// 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
        //動態設置數據
        myChart.showLoading();
        getChartActiveUserData(myChart);
	}
	</script>
	
	<script type="text/javascript">
	function initChartUserUpdate(){
		// 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('userupdatechart'));
		var option = {
		    title: {
		        text: '近期用户增长情况',
		        x:'center'
		    },
		    tooltip: {
		        trigger: 'axis',
		        axisPointer: {
		            type: 'cross'
		        }
		    },
		    toolbox: {
		        show: true,
		        feature: {
		            saveAsImage: {}
		        }
		    },
		    xAxis:  {
		        type: 'category',
		        boundaryGap: false,
		        data: ['00:00', '01:15', '02:30', '03:45', '05:00', '06:15', '07:30', '08:45', '10:00', '11:15', '12:30', '13:45', '15:00', '16:15', '17:30', '18:45', '20:00', '21:15', '22:30', '23:45']
		    },
		    yAxis: {
		        type: 'value',
		        axisLabel: {
		            formatter: '{value}'
		        },
		        axisPointer: {
		            snap: true
		        }
		    },
		    series: [
		        {
		            name:'用户增长量',
		            type:'line',
		            smooth: true,
		            data: [300, 280, 250, 260, 270, 300, 550, 500, 400, 390, 380, 390, 400, 500, 600, 750, 800, 700, 600, 400]
		        }
		    ]
		};

		// 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
        //動態設置數據
        myChart.showLoading();
        getChartUserUpdateData(myChart)
	}
	</script>
	
	<script type="text/javascript">
	function getChartGenderData(myChart){
		$
		.ajax({
			url : "http://localhost:8080/easybike/restful/user/getUserGender",
			type : "post",
			dataType : "json",
			success : function(result) {
				var r = result;
				var obj = r.obj;
				var retcode = r.retcode;
				var errorMsg = r.errorMsg;
				if (retcode != "0000") {
					alert(errorMsg);
				} else {
					arr=obj.split(":");
					myChart.setOption({
					    series: [
					        {
					            data:[
					                {value:arr[0], name:'男'},
		                			{value:arr[1], name:'女'}
					            ]
					        }
					    ]
				    	});
				    myChart.hideLoading();
				}
			}
		});
	}
	</script>
	
	<script type="text/javascript">
	function getChartActiveUserData(myChart){
		$
		.ajax({
			url : "http://localhost:8080/easybike/restful/user/getActiveUser",
			type : "post",
			dataType : "json",
			success : function(result) {
				var r = result;
				var obj = r.obj;
				var retcode = r.retcode;
				var errorMsg = r.errorMsg;
				if (retcode != "0000") {
					alert(errorMsg);
				} else {
					var arrTime = new Array();
					var arrNum = new Array();
					$.each(obj,function(index,item){
						arrTime.unshift(item.date);
						arrNum.unshift(item.num);
					});
					myChart.setOption({
						xAxis : [
					        {
					            type : 'category',
					            data : arrTime,
					            axisTick: {
					                alignWithLabel: true
					            }
					        }
					    ],
					    series: [{data:arrNum}]
				    	});
				    myChart.hideLoading();
				}
			}
		});
	}
	</script>
	
	<script type="text/javascript">
	function getChartUserUpdateData(myChart){
		$
		.ajax({
			url : "http://localhost:8080/easybike/restful/user/getUserIncrease",
			type : "post",
			dataType : "json",
			success : function(result) {
				var r = result;
				var obj = r.obj;
				var retcode = r.retcode;
				var errorMsg = r.errorMsg;
				if (retcode != "0000") {
					alert(errorMsg);
				} else {
					var arrTime = new Array();
					var arrNum = new Array();
					$.each(obj,function(index,item){
						arrTime.unshift(item.date);
						arrNum.unshift(item.number);
					});
					myChart.setOption({
						xAxis:  {
					        data: arrTime
					    },
					    series: [
					        {
					            data: arrNum
					        }
					    ]
				    });
				    myChart.hideLoading();
				}
			}
		});
	}
	</script>
	
	<script type="text/javascript">
	function getCurrentTime(){
		var now=new Date(); 
		$("#time1").text("統計時間："+(parseInt(1900)+ parseInt(now.getYear()))+"-"+now.getDate()+" "+now.getHours()+":"+now.getMinutes()+":"+now.getSeconds());
		$("#time2").text("統計時間："+ (parseInt(1900)+ parseInt(now.getYear()))+"-"+(now.getMonth()+1)+"-"+now.getDate()+" "+now.getHours()+":"+now.getMinutes()+":"+now.getSeconds());
		$("#time3").text("統計時間："+ (parseInt(1900)+ parseInt(now.getYear()))+"-"+(now.getMonth()+1)+"-"+now.getDate()+" "+now.getHours()+":"+now.getMinutes()+":"+now.getSeconds());
	}
	</script>
</body>

</html>
